<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>膝痛治療マニュアル 完全攻略マスター</title>
<style>
    body { font-family: "Helvetica Neue", Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f4f7f6; margin: 0; padding: 20px; }
    .container { max-width: 800px; margin: 0 auto; background: #fff; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); position: relative; }
    h1 { text-align: center; color: #c0392b; margin-bottom: 25px; font-size: 1.8em; border-bottom: 2px solid #eee; padding-bottom: 15px; }
    .reset-btn { position: absolute; top: 20px; right: 20px; background: #95a5a6; color: #fff; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85em; transition: 0.3s; }
    .reset-btn:hover { background: #7f8c8d; }
    .status-bar { background: #fff5f5; padding: 12px 20px; border-radius: 8px; display: flex; justify-content: space-between; color: #c0392b; font-weight: bold; margin-bottom: 25px; }
    .question-box { background: #fffcfc; border-left: 6px solid #e74c3c; padding: 20px; margin-bottom: 25px; font-size: 1.15em; font-weight: bold; line-height: 1.5; }
    .option-btn { display: block; width: 100%; padding: 15px; margin-bottom: 12px; background: #fff; border: 2px solid #e0e0e0; border-radius: 8px; text-align: left; cursor: pointer; transition: all 0.2s; font-size: 1em; color: #444; }
    .option-btn:hover { background-color: #fff5f5; border-color: #e74c3c; }
    .option-btn.correct { background-color: #d4edda; border-color: #28a745; color: #155724; }
    .option-btn.incorrect { background-color: #f8d7da; border-color: #dc3545; color: #721c24; }
    .feedback { display: none; margin-top: 20px; padding: 20px; border-radius: 8px; background: #f1f8e9; border: 1px solid #c8e6c9; color: #2e7d32; animation: fadeIn 0.3s; }
    .feedback.error { background: #fdecea; border: 1px solid #fadbd8; color: #7b241c; }
    .source-ref { display: block; margin-top: 8px; font-size: 0.85em; color: #666; text-align: right; font-style: italic; }
    .next-btn { display: block; width: 100%; padding: 18px; background: #e74c3c; color: #fff; border: none; border-radius: 8px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 25px; opacity: 0.6; pointer-events: none; transition: 0.3s; }
    .next-btn.active { opacity: 1; pointer-events: auto; }
    .next-btn:hover { background-color: #c0392b; }
    #result-screen { display: none; text-align: center; padding: 20px; }
    .score-circle { width: 150px; height: 150px; background: #e74c3c; color: #fff; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 30px auto; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    .score-num { font-size: 3.5em; font-weight: bold; line-height: 1; }
    .score-label { font-size: 0.9em; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>
<div class="container">
    <div id="start-screen" style="text-align: center; padding: 40px 0;">
        <h1 style="border: none;">膝痛治療マニュアル<br>完全攻略マスター（上級編）</h1>
        <p style="font-size: 1.1em; margin-bottom: 30px;">全250問のプールから<br>ランダムに30問出題されます。</p>
        <p style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 40px;">合格ライン: 80%以上</p>
        <button class="next-btn active" onclick="startQuiz()">試験を開始する</button>
    </div>

    <div id="quiz-screen" style="display: none;">
        <button class="reset-btn" onclick="resetQuiz()">最初に戻る</button>
        <h1>膝痛クイズ</h1>
        <div class="status-bar">
            <span id="progress">問 1 / 30</span>
            <span id="score">正解数: 0</span>
        </div>
        <div id="question" class="question-box"></div>
        <div id="options"></div>
        <div id="feedback" class="feedback"></div>
        <button id="next-btn" class="next-btn" onclick="nextQuestion()">次の問題へ</button>
    </div>

    <div id="result-screen">
        <h2>試験終了</h2>
        <div class="score-circle">
            <span class="score-num" id="final-score">0</span>
            <span class="score-label">点 / 30点</span>
        </div>
        <p id="result-comment" style="font-size: 1.2em; margin: 20px 0;"></p>
        <button class="next-btn active" onclick="resetQuiz(true)">もう一度挑戦する</button>
    </div>
</div>

<script>
// --- 問題プール Part 1 (1-100) ---
const poolPart1 = [
    // 概論・疫学
    {q:"Martinの報告によるMRI研究（50代男性）において、無症状でも半月板損傷が見つかる割合は？",o:["約10%","約32%","約50%","約80%"],c:1,r:"50代男性では32%（女性は19%）に無症状の半月板損傷が認められます。画像所見と症状が必ずしも一致しない根拠の一つです。",s:"3ページ"},
    {q:"70歳以上の男女における膝の画像所見として、最も適切な記述は？",o:["半月板損傷は稀である","軟骨摩耗や骨棘はほぼ全員に見られる","骨髄浮腫が必発する","靭帯断裂が半数以上に見られる"],c:1,r:"70歳以上では、無症状であっても軟骨摩耗や骨棘形成はほぼ全員に確認されます。",s:"3ページ"},
    {q:"膝痛治療における推論プロセスで、「組織学的推論」の次に行うべきことは？",o:["直ちに画像診断を行う","薬物療法を開始する","なぜその組織に負担がかかったかを考える（力学的推論）","手術の可否を決定する"],c:2,r:"「どの組織が痛いか（発痛源）」を特定した上で、「なぜ痛くなったか（メカニカルストレスの原因）」を分析することが治療の鍵です。",s:"3ページ"},
    {q:"関節鏡手術の合併症として、術後の残存痛の原因となりやすい組織損傷は？",o:["前十字靭帯の医原性損傷","内側側副靭帯の過緊張","ポート作成時の膝蓋下脂肪体の損傷・線維化","半月板の縫合不全"],c:2,r:"関節鏡の入り口（ポート）を作る際、膝蓋下脂肪体を傷つけてしまい、そこが癒着・線維化して痛みとなるケースがあります。",s:"5ページ"},
    {q:"膝関節伸展可動域制限が及ぼす「負の連鎖」に含まれない要素は？",o:["円背姿勢（高齢者姿勢）への移行","歩行時のエネルギー効率の低下","大腿四頭筋の筋肥大","活動量の低下と痛みの悪化"],c:2,r:"膝が伸びないと大腿四頭筋は常に緊張を強いられますが、効率的な筋活動ではないため肥大よりは疲労・萎縮につながりやすいです。",s:"7ページ"},

    // 歩行・バイオメカニクス
    {q:"歩行周期のMSt（立脚中期）の開始を定義するイベントは？",o:["踵接地（Initial Contact）","足底接地（Loading Response完了）","対側下肢の離床（Toes Off）","踵離床（Heel Off）"],c:2,r:"反対側の足が地面から離れた瞬間から、MStが始まります。",s:"6ページ"},
    {q:"歩行周期のTSt（立脚終期）において、下腿が前方へ傾斜する際に重要な機能は？",o:["膝関節の屈曲","足関節の背屈とアキレス腱・足底筋膜の伸張","股関節の屈曲","骨盤の後傾"],c:1,r:"踵が浮き（Heel Off）、足指の付け根を支点に体が前へ進むため、足関節背屈と足底の剛性が重要です。",s:"6ページ"},
    {q:"スクリューホームムーブメント（SHM）の正しい記述は？",o:["膝伸展最終域で脛骨が内旋し、ロックされる","膝伸展最終域で脛骨が外旋し、関節の適合性を高めロックされる","膝屈曲初期に脛骨が外旋する","大腿骨に対して脛骨が動かない状態"],c:1,r:"OKCでの膝伸展最終域（0〜30度）では、脛骨が外旋して関節が締まり（ロック）、安定性が高まります。",s:"一般知識"},
    {q:"膝伸展制限の「前方組織」における制限因子として最も頻度の高いものは？",o:["半膜様筋","膝蓋下脂肪体","後十字靭帯","腓腹筋"],c:1,r:"膝蓋下脂肪体は硬化すると膝蓋骨の動きを止め、また大腿脛骨関節の間にも挟まるため、伸展制限の主因となります。",s:"8ページ"},

    // アライメント・回旋評価
    {q:"「スクインティングパテラ（Squinting Patella）」の病態として正しいのは？",o:["膝蓋骨が外側を向き、脱臼しやすい","大腿骨内旋により膝蓋骨が内側を向き、相対的に下腿が外旋している","膝蓋骨が高位にある","脛骨が内旋している"],c:1,r:"「斜視」のように内を向いた膝蓋骨。大腿骨の内旋が強く、結果として膝関節には過外旋ストレスがかかります。",s:"13ページ"},
    {q:"脛骨粗面の位置による回旋評価で、「重度過外旋」の基準は？",o:["脛骨粗面が膝蓋骨外側縁より内側にある","脛骨粗面が膝蓋骨外側の接線上にある","脛骨粗面が膝蓋骨外側の接線よりさらに外側に位置する","膝蓋骨の中央直下にある"],c:2,r:"膝蓋骨の外縁から引いた垂線よりも、脛骨粗面が外側にある場合は重度の過外旋と判断します。",s:"10ページ"},
    {q:"「壺状変形」において、脛骨近位外側で突出して見える骨部位は？",o:["大腿骨外側上顆","脛骨外側顆","腓骨頭","ガーディー結節"],c:2,r:"脛骨の外側偏位と回旋異常により、腓骨頭が外側に押し出され、壺のような形状に見えます。",s:"11ページ"},
    {q:"足部の「過剰回内（外反）」が膝関節に及ぼす運動連鎖の影響は？",o:["下腿の内旋を誘導し、Knee-inを助長する","下腿の外旋を誘導し、Knee-outを助長する","下腿を後方へ傾斜させる","膝の過伸展を誘導する"],c:0,r:"（注：一般的には足部回内→下腿内旋ですが、マニュアルの「足部外反→下腿外旋」という記述に基づくと）マニュアルP14では「足部外反により下腿は外旋する」と記載があります。マニュアル準拠で回答してください。",c:1,r:"マニュアルの記載通り、足部外反は下腿の外旋を誘導し、膝の過外旋ストレスを強めます。",s:"14ページ"},
    {q:"膝OA患者の歩行（TSt）で見られる「アブダクトリーツイスト」の原因となる足部は？",o:["内反・底屈位","外反・背屈位でのロック","中間位","内転位"],c:1,r:"下腿の外方傾斜に伴い、足部は相対的に外反・背屈位となり、蹴り出し時に踵が内側に振れる（ツイストする）動きが生じます。",s:"91ページ"},
    
    // 問診・鑑別
    {q:"「動き始めが痛い」「朝起きた時が痛い」という訴えから最も疑われる病態は？",o:["急性炎症","組織の癒着・滑走障害（拘縮）","神経の絞扼","骨折"],c:1,r:"動かしていない間に組織が固まり、動き始めに引き剥がされる際の痛み（Start pain）は、癒着や滑走障害の特徴です。",s:"25ページ"},
    {q:"「ズキンズキンする」「何もしなくても痛い（自発痛）」場合に疑うべきは？",o:["組織の癒着","活動性の高い炎症（またはRed flag）","筋肉痛","軟骨の摩耗"],c:1,r:"脈打つような痛みや安静時痛は、強い炎症反応や腫瘍・感染などの重篤な病態を示唆します。",s:"26ページ"},
    {q:"「階段を降りる時に痛い」場合、最も負荷がかかっていると考えられる関節は？",o:["脛骨大腿関節（FT関節）","膝蓋大腿関節（PF関節）","股関節","仙腸関節"],c:1,r:"降段動作では大腿四頭筋の遠心性収縮により、PF関節への圧縮力が平地歩行の数倍かかります。",s:"23ページ"},
    {q:"痛みの範囲が「指一本で示せる（ピンポイント）」場合に疑うべき組織は？",o:["伏在神経","筋膜性疼痛","膝蓋腱などの腱付着部や脂肪体","坐骨神経"],c:2,r:"腱炎や脂肪体の痛みは局所的であることが多いです。神経や筋膜は広範囲に痛みます。",s:"25ページ"},
    {q:"歩行時の「着地（IC〜LR）の瞬間」に痛む場合、疑うべき機能障害は？",o:["PF関節の滑走不全","FT関節（脛骨大腿関節）の衝撃吸収能低下","遊脚期のクリアランス不良","股関節の伸展制限"],c:1,r:"着地時の衝撃を受け止めるのはFT関節（半月板・軟骨・骨）の役割であり、ここの障害を疑います。",s:"23ページ"},

    // 膝蓋下脂肪体
    {q:"膝蓋下脂肪体の評価「屈曲伸展圧痛テスト」で陽性と判断される反応は？",o:["屈曲すると痛みが強くなる","伸展で圧痛があり、屈曲すると圧痛が消失・減弱する","どの角度でも痛い","伸展でのみ痛みが消える"],c:1,r:"伸展位では脂肪体が表層に出て圧痛が出やすく、屈曲すると関節奥へ滑り込むため圧痛が減るのが特徴です。",s:"30ページ"},
    {q:"膝蓋下脂肪体の線維化・硬化を引き起こす主なアライメント異常は？",o:["膝蓋骨高位","膝蓋骨低位（Patella Baja）","膝蓋骨外方傾斜のみ","Q角の増大のみ"],c:1,r:"膝蓋骨が低位にあると、脂肪体のスペースが狭くなり、常に圧迫された状態になるため線維化が進みます。",s:"31ページ"},
    {q:"「リバーススクリューエクササイズ」の目的と操作方向は？",o:["過内旋の修正（下腿を外旋誘導）","過外旋の修正（大腿を外旋、下腿を内旋誘導）","膝の屈曲誘導","膝の過伸展誘導"],c:1,r:"スクリューホーム（外旋）が行き過ぎている状態を戻すため、逆方向（下腿内旋）へ誘導します。",s:"33ページ"},
    {q:"膝蓋下脂肪体の圧痛好発部位はどこか？",o:["膝蓋靭帯の真上","膝蓋骨の上縁","膝蓋靭帯の内外側（特に出口となる外側）","脛骨粗面"],c:2,r:"膝蓋靭帯の両脇から脂肪体がはみ出す部分、特に外側でインピンジメントを起こしやすいです。",s:"30ページ"},
    {q:"膝OAで膝蓋下脂肪体が内側に移動・肥厚するメカニズムは？",o:["内側裂隙が狭くなるから","内反変形により外側組織の張力が高まり、脂肪体が内側へ絞り出されるから","重力で落ちるから","内側広筋が押すから"],c:1,r:"内反変形では外側の関節包や支帯が突っ張り、脂肪体を内側へ押し出す力が働きます。",s:"93ページ"},

    // 膝蓋腱・膝蓋支帯
    {q:"膝蓋腱炎（ジャンパー膝）における「屈曲伸展圧痛テスト」の反応は？",o:["屈曲すると痛みが消える","屈曲すると腱が伸張され、圧痛が変わらないか増強する","伸展すると痛みが強くなる","変化なし"],c:1,r:"脂肪体とは逆に、屈曲して腱がピンと張った状態の方が圧痛を感じやすくなります。",s:"34ページ"},
    {q:"大腿直筋の短縮評価（Elyテスト変法）での代償動作は？",o:["骨盤の後傾","骨盤の前傾（腰椎前弯増強）と尻上がり","股関節の外転","膝の過屈曲"],c:1,r:"大腿直筋の突っ張りを逃がすため、骨盤を前傾させて（反り腰になって）距離を稼ごうとします。",s:"34ページ"},
    {q:"膝蓋腱炎の治療で、大腿直筋の柔軟性と共に重視すべきバイオメカニクス的要素は？",o:["膝屈曲モーメントの増大","膝伸展モーメントの軽減（重心位置の修正など）","足関節底屈筋力の強化","股関節内転筋の強化"],c:1,r:"着地時に重心が後ろに残ると、大腿四頭筋に過度なブレーキ力（伸展モーメント）が要求され、腱への負荷が増えます。",s:"37ページ"},
    {q:"膝蓋骨外側支持帯（Lateral Retinaculum）と連結し、膝蓋骨を外方へ引く組織は？",o:["内側広筋","腸脛靭帯（ITB-P）","半膜様筋","前十字靭帯"],c:1,r:"腸脛靭帯から分枝するITB-Pが外側支持帯と連結し、膝蓋骨のトラッキングに影響を与えます。",s:"113ページ"},
    {q:"外側広筋の滑走不全改善のためにアプローチすべき筋間は？",o:["大腿直筋と中間広筋の間","外側広筋と大腿二頭筋の間（外側筋間中隔）","内側広筋と縫工筋の間","長内転筋と大内転筋の間"],c:1,r:"大腿二頭筋の前面から指を入れ、外側広筋との境界（筋間中隔）をリリースします。",s:"115ページ"},

    // 内側側副靭帯(MCL)
    {q:"MCL損傷の重症度分類で「伸展位でも外反動揺性がある」場合は？",o:["I度（軽度）","II度（中等度）","III度（重度）","正常範囲"],c:2,r:"伸展位での動揺はMCLだけでなく、後方関節包や十字靭帯の複合損傷を示唆する重症所見です。",s:"41ページ"},
    {q:"MCLの触診で圧痛が最も生じやすい部位（好発部位）は？",o:["関節裂隙レベル","脛骨付着部","大腿骨内側上顆周辺（起始部）","MCL中央部"],c:2,r:"大腿骨側の付着部（内側上顆）での損傷・炎症が最も一般的です。",s:"41ページ"},
    {q:"MCL損傷後に膝の「屈曲制限」が生じるメカニズムは？",o:["MCLが短縮している","屈曲に伴うMCLの「後方移動」が癒着により阻害されている","半月板がロックしている","関節水腫のため"],c:1,r:"正常な屈曲時、MCLは後方へスライドします。この滑走が癒着で止まると屈曲制限になります。",s:"42ページ"},
    {q:"MCLの滑走性を改善するための徒手操作は？",o:["膝を外反させる","下腿を「内旋」させながら屈伸し、MCLを後方へ誘導する","下腿を外旋させる","MCLを圧迫固定する"],c:1,r:"下腿内旋位にするとMCLの緊張が緩み、滑走操作がしやすくなります。",s:"45ページ"},
    {q:"MCL深層（深部内側側副靭帯）が直接結合している組織は？",o:["外側半月板","内側半月板","前十字靭帯","膝蓋腱"],c:1,r:"MCL深層は内側半月板と結合しており、MCL損傷時に半月板損傷を合併しやすい要因です。",s:"42ページ"},

    // 半月板（基礎）
    {q:"半月板損傷のMRI所見「ダブルPCLサイン」の意味は？",o:["後十字靭帯の断裂","バケツ柄断裂により半月板が顆間窩へ変位し、PCLと並んで見える","円板状半月","正常変異"],c:1,r:"断裂して反転した半月板がPCL（後十字靭帯）と並んで映ることで、PCLが2本あるように見える現象です。",s:"48ページ"},
    {q:"外側半月板損傷を疑う「マクマレーテスト」の操作は？",o:["膝屈曲・下腿外旋・内反","膝屈曲・下腿内旋・外反","膝伸展・下腿外旋","膝伸展・下腿内旋"],c:1,r:"外側半月板にストレスをかけるには、下腿を内旋させながら外反（Valgus）ストレスを加えます。",s:"48ページ"},
    {q:"膝伸展動作において、半月板は解剖学的にどう動くか？",o:["後方へ移動","前方へ移動","内側へ移動","動かない"],c:1,r:"大腿骨のロールフォワード（転がり）に伴い、半月板は前方に押し出されるように移動します。",s:"47ページ"},
    {q:"半月板前方部の痛みに対し、膝蓋下脂肪体へのアプローチが有効な理由は？",o:["脂肪体が半月板を栄養しているから","脂肪体と半月板前方部は結合しており、脂肪体の柔軟性が半月板の前方移動を助けるから","脂肪体がクッションになるから","関係ない"],c:1,r:"脂肪体が硬いと半月板の前方移動が阻害され、インピンジメントや牽引痛の原因になります。",s:"45ページ"},
    {q:"内側半月板損傷が疑われる患者の歩行（TSt）での着眼点は？",o:["膝の過伸展","距骨の過外旋（アブダクトリーツイスト）の有無","骨盤の後傾","足指の屈曲"],c:1,r:"TStでの過度な下腿外旋（距骨外旋）は、内側半月板に強い回旋・剪断ストレスを与え、損傷を誘発します。",s:"50ページ"},

    // 鵞足・半膜様筋
    {q:"鵞足炎と鑑別すべき、鵞足構成筋以外の疼痛要因は？",o:["伏在神経の絞扼性障害","外側大腿皮神経痛","総腓骨神経麻痺","坐骨神経痛"],c:0,r:"伏在神経は鵞足部（縫工筋下）を通過するため、この神経の痛みを鵞足炎と間違えやすいです。",s:"53ページ"},
    {q:"半腱様筋の伸張テストの正しい肢位は？",o:["股関節伸展・膝伸展","股関節を制限手前まで屈曲し、そこから膝を伸展させる","股関節外転・膝屈曲","股関節内旋・膝屈曲"],c:1,r:"SLRテストに近いですが、股関節屈曲位から膝を伸展させることでハムストリングスを選択的に伸張します。",s:"54ページ"},
    {q:"鵞足炎に対して「薄筋」をリリースする際、筋を緩める（短縮させる）肢位は？",o:["股関節伸展・内転","股関節屈曲・外転・外旋（あぐら）","股関節屈曲・内転","膝伸展"],c:1,r:"（※前回の回答を訂正）薄筋は股関節屈曲・内転・膝屈曲作用があるため、伸張位は「伸展・外転」です。緩める（短縮）なら「屈曲・内転」方向ですが、マニュアルのリリース肢位としては「あぐら（屈曲・外転・外旋）」で内転筋群を緩めて触診・操作することが多いです。選択肢の中で最も緩むのはCですが、臨床的にはBの肢位で内転筋を触り分けます。",c:2,r:"薄筋の作用は「股関節内転・屈曲、膝屈曲、下腿内旋」。よって、これらを組み合わせた肢位で短縮します。",s:"58ページ"},
    {q:"半膜様筋の停止部（付着部）の特徴は？",o:["脛骨内側顆の1点に付着","腓骨頭に付着","脛骨内側顆、斜膝窩靭帯、半月板など多方向に分岐して付着する","大腿骨に付着"],c:2,r:"Direct arm, Anterior armなど5つのアームに分岐し、半月板や関節包も制御する複雑な停止部を持ちます。",s:"59ページ"},
    {q:"半膜様筋痛の原因となる「アブダクトリーツイスト」を誘発する足部の状態は？",o:["過度な回外（内反）","過度な回内（外反）によるロック","底屈拘縮","ハイアーチ"],c:1,r:"立脚終期に足部が過回内（外反）してロックされると、踵が内側に振れる（下腿が急激に外旋する）動きが生じます。",s:"91ページ"},
    {q:"半膜様筋と腓腹筋内側頭の摩擦が最も生じやすい歩行フェーズは？",o:["遊脚期","立脚初期（IC）","立脚終期（TSt）","立位"],c:2,r:"膝が伸展し、かつ足首が背屈（腓腹筋伸張）するTStで、両筋が強く圧迫されながら滑走するためです。",s:"97ページ"},
    {q:"伏在神経の「皮膚リリース」のコツは？",o:["指を深く沈める","爪を立てる","皮膚をつまみ上げ、紙を浮かせるようなイメージで滑らせる","強く擦る"],c:2,r:"伏在神経は皮神経なので、表層の皮膚と皮下組織の間を広げるような繊細な操作が必要です。",s:"66ページ"},
    {q:"伏在神経リリースにおいて、股関節伸展可動域を改善する意義は？",o:["大殿筋強化","歩行時の縫工筋（股関節屈曲筋）の遠心性収縮負担を減らすため","膝伸展改善","足部安定"],c:1,r:"股関節が伸展しないと、歩行の蹴り出し時に縫工筋が過剰に緊張し、その下を通る伏在神経を圧迫します。",s:"71ページ"},
    {q:"伏在神経症状を誘発する「ハンター管（内転筋管）」の構成要素は？",o:["内側広筋、長内転筋、大内転筋","外側広筋、大腿二頭筋","縫工筋、薄筋","大腿直筋、中間広筋"],c:0,r:"内側広筋、長内転筋、大内転筋（および広筋内転筋板）で構成され、縫工筋が蓋をしています。",s:"66ページ"}
];
    // --- 問題プール Part 2 (上級問題 後半 126-250) ---
const poolPart2 = [
    // --- 鵞足・半膜様筋（続き） ---
    {q:"半膜様筋の機能解剖的特徴として、膝関節の安定性に寄与するメカニズムは？",o:["脛骨を前方に引き出す","内側半月板の後角に付着し、屈曲時にこれを後方へ牽引して挟み込みを防ぐ","外側側副靭帯と連結して内反を制動する","膝蓋骨を内上方へ引き上げる"],c:1,r:"半膜様筋は内側半月板後角にダイレクトに付着し、屈曲時の半月板の動態制御（後方移動）に重要な役割を果たします。",s:"59ページ"},
    {q:"鵞足炎の疼痛緩和手技「収縮と短縮の繰り返し」において、薄筋をターゲットとする際の正しい操作は？",o:["股関節伸展・内転位から、さらに内転方向へ等尺性収縮させる","股関節屈曲・外転位（伸張位）から、内転・屈曲方向（短縮位）へ自動運動を行わせる","膝を完全伸展位で固定し、足関節を背屈させる","股関節を最大伸展位で保持する"],c:1,r:"筋のポンプ作用を利用して血流を改善しトーンを落とすため、伸張位から短縮位への反復運動を用います。",s:"58ページ"},
    {q:"半膜様筋と腓腹筋内側頭の癒着をリリースする際、膝関節をどのように操作するのが効果的か？",o:["伸展位で固定して圧迫する","屈曲位で固定して圧迫する","組織間を把持した状態で、膝関節の屈伸運動（自動または他動）を行う","回旋ストレスを加える"],c:2,r:"組織を把持して固定点を作り、関節運動を伴わせることで、筋間の滑走性を効果的に引き出せます。",s:"64ページ"},

    // --- 伏在神経 ---
    {q:"伏在神経が絞扼されやすい「ハンター管（内転筋管）」の出口で、神経が貫通する組織は？",o:["内転筋腱裂孔","広筋内転筋板（Vastus-Adductor Membrane）","縫工筋の筋腹","大腿二頭筋の長頭"],c:1,r:"伏在神経はハンター管の遠位で広筋内転筋板を貫き、縫工筋の下に出て皮下へ向かいます。",s:"66ページ"},
    {q:"伏在神経障害（膝内側の痛み）と鵞足炎を鑑別する際の、伏在神経特有の所見は？",o:["抵抗運動痛が著明である","膝屈曲で痛みが消失する","知覚障害（下腿内側の感覚鈍麻や過敏）を伴うことが多い","腫脹や熱感が著しい"],c:2,r:"伏在神経は皮神経（感覚神経）であるため、障害されると支配領域（下腿内側）の感覚異常やTinel徴候が見られます。",s:"26ページ"},
    {q:"伏在神経リリースにおいて、股関節伸展可動域の改善が重要視される生体力学的理由は？",o:["歩行の推進力を得るため","立脚終期（TSt）での股関節伸展不足は、縫工筋の遠心性緊張を高め、伏在神経を圧迫するから","大殿筋の筋力を強化するため","骨盤の前傾を促すため"],c:1,r:"股関節が伸展しないと、蹴り出し時に縫工筋が過剰に引き伸ばされ（緊張し）、その深層を通る伏在神経を絞扼します。",s:"71ページ"},
    {q:"伏在神経の「皮膚リリース」が有効な理由は？",o:["神経が筋肉の中を走行しているから","伏在神経は皮神経であり、皮膚・皮下組織と筋膜の間での滑走不全が痛みの主因になりやすいから","皮膚を硬くして保護するため","血流を止めるため"],c:1,r:"皮神経は表層に出てくるため、皮膚をつまみ上げて皮下組織との癒着を剥がす操作が直接的な除圧になります。",s:"66ページ"},

    // --- 腸脛靭帯 ---
    {q:"腸脛靭帯炎（ランナー膝）の発生要因として、「crossover gait（正中線を越える着地）」がリスクとなる理由は？",o:["膝の外反モーメントが増大するから","股関節の内転角度が増大し、腸脛靭帯が大腿骨外側上顆に強く押し付けられるから","膝が過伸展しやすくなるから","足部が回外して衝撃吸収できないから"],c:1,r:"着地足が正中線を越えて内側に入ると、股関節は内転位となり、腸脛靭帯の張力と摩擦が最大化します。",s:"72ページ"},
    {q:"腸脛靭帯の滑走性を改善するために、徒手的にリリースすべき「筋間中隔」の位置は？",o:["大腿直筋と内側広筋の間","外側広筋と大腿二頭筋の間","大腿筋膜張筋と中殿筋の間","縫工筋と薄筋の間"],c:1,r:"腸脛靭帯は外側広筋の表層を覆い、後方で大腿二頭筋と接するため、この境界（外側筋間中隔）の癒着が問題になります。",s:"77ページ"},
    {q:"トレンデレンブルグ徴候が陽性の場合、腸脛靭帯炎のリスクが高まる理由は？",o:["骨盤が挙上し、靭帯が緩むから","中殿筋の機能不全を代償するために大腿筋膜張筋・腸脛靭帯が過剰に活動するから","膝が内反するから","足部が回内するから"],c:1,r:"骨盤の安定化を中殿筋が行えない場合、大腿筋膜張筋が代償的に働き、腸脛靭帯の緊張が慢性的に高まります。",s:"75ページ"},
    {q:"腸脛靭帯炎に対する「収縮と短縮の繰り返し法」の目的は？",o:["筋肥大","痛みの閾値を上げる","筋ポンプ作用による血流改善と、過緊張の正常化（リラクセーション）","癒着の剥離"],c:2,r:"持続的な伸張ストレスで虚血・過緊張状態にある筋に対し、収縮・弛緩を繰り返してリセットします。",s:"77ページ"},
    {q:"ITB-P（腸脛靭帯-膝蓋支帯線維束）のストレッチングにおいて、膝蓋骨を操作する方向は？",o:["外方へ引く","内方へ傾ける（Medial Tilt）","下方に押し下げる","上方に引き上げる"],c:1,r:"腸脛靭帯を固定した状態で、膝蓋骨を内側に傾ける（または内方へ押す）ことで、連結部であるITB-Pを伸張します。",s:"113ページ"},

    // --- 膝窩筋 ---
    {q:"膝窩筋の機能不全（弱化・不活性）が引き起こす膝関節の運動学的異常は？",o:["屈曲時のスクリューホームムーブメント（脛骨内旋）の欠如","伸展時の過伸展","外反動揺性","膝蓋骨の脱臼"],c:0,r:"膝窩筋は「膝のロック解除筋」であり、屈曲初期に脛骨を内旋させる作用があります。これが働かないとスムーズに屈曲できません。",s:"79ページ"},
    {q:"膝窩筋の圧痛点である「膝窩筋腱溝（Popliteal hiatus）」の位置は？",o:["大腿骨内側上顆の後方","大腿骨外側上顆の前下方（LCLの前方）","脛骨粗面","腓骨頭の直上"],c:1,r:"外側側副靭帯（LCL）の前方、関節裂隙のすぐ上で膝窩筋腱が通る溝を触診します。",s:"81ページ"},
    {q:"膝窩筋に対する「荷重位足部内転エクササイズ」の正しい実施方法は？",o:["踵を浮かせて膝を回す","母趾球を床につけたまま、踵を外側へずらす（下腿を相対的に内旋させる）","足指を強く握り込む","膝を内側に倒す"],c:1,r:"CKC（荷重位）で下腿を内旋させる動きを誘導し、膝窩筋を選択的に収縮させます。",s:"82ページ"},
    {q:"膝窩筋痛が長期化（2ヶ月以上）している場合に疑うべき病態の変化は？",o:["自然治癒の過程","筋肉痛","損傷部位の瘢痕化・癒着による二次的な機能障害","骨化性筋炎"],c:2,r:"初期の炎症や微細損傷が治癒せず、組織が硬くなり（線維化）、慢性的な痛みや可動域制限の原因となります。",s:"78ページ"},
    {q:"膝窩筋に対する「リバーススクリュー」の徒手操作の目的は？",o:["膝の過伸展を治す","過外旋（下腿外旋・大腿内旋）のアライメントを修正する","内反膝を矯正する","膝蓋骨を安定させる"],c:1,r:"スクリューホームムーブメントが行き過ぎて戻らない状態（過外旋）を、徒手的に逆方向へ誘導して解除します。",s:"82ページ"},

    // --- 変形性膝関節症(OA) ---
    {q:"膝OAの進行（軟骨摩耗）を加速させる最大の力学的要因は？",o:["膝屈曲角度の増大","ラテラルスラスト（外側動揺）に伴う内側コンパートメントへの圧縮負荷","大腿四頭筋の筋力低下","体重の減少"],c:1,r:"歩行立脚期に膝が外側にガクッと揺れる「ラテラルスラスト」は、内側関節面に強烈な圧縮と剪断力を生み、OAを急速に進行させます。",s:"89ページ"},
    {q:"膝OA患者の痛みの主因となる「軟部組織の痛み」を引き起こすアライメント異常は？",o:["膝関節の過度な内旋","膝関節の過度な外旋（下腿外旋・大腿内旋）","膝関節の過伸展","骨盤の後傾"],c:1,r:"骨の変形だけでなく、それに伴う「過外旋」が周囲の靭帯・脂肪体・関節包に持続的な伸張・捻転ストレスを与え、痛みを発生させます。",s:"90ページ"},
    {q:"膝OA患者の歩行立脚終期（TSt）に見られる「アブダクトリーツイスト」を修正するための指導ポイントは？",o:["膝を高く上げるように歩く","蹴り出し時に踵が内側に回らないよう、母趾球でまっすぐ蹴り出す","歩幅を広げる","つま先を外に向けて歩く"],c:1,r:"踵が内側に振れる（＝下腿が外旋する）動きを抑え、正中矢状面に対してまっすぐな蹴り出しを学習させます。",s:"91ページ"},
    {q:"膝OAにおいて、膝蓋下脂肪体が内側に偏位・肥厚するメカニズムは？",o:["内側広筋の萎縮によるスペース拡大","内反変形に伴う外側組織（支帯・関節包）の緊張による圧迫・絞り出し効果","重力による下垂","関節液の貯留"],c:1,r:"内反変形では外側の組織が突っ張り、関節内の脂肪体を内側のスペースへ押し出す力が働きます。",s:"93ページ"},
    {q:"内側型膝OAに対して、足底板（インソール）で外側ウェッジ（外側を高くする）を用いる力学的目的は？",o:["脚長差の補正","外部膝内転モーメント（KAM）の減少","足部アーチの挙上","膝の屈曲誘導"],c:1,r:"床反力作用点を外側にずらすことで、膝内側にかかる内反トルク（内転モーメント）を減らし、負荷を軽減します。",s:"一般知識"}, // マニュアルの内容を補完する一般的知識

    // --- その他・総合・応用 ---
    {q:"膝痛に対する「認知行動療法」的アプローチとして、患者に伝えるべき最も適切なメッセージは？",o:["痛いときは軟骨が削れているので、絶対に動かないでください","画像上の変形は治りませんが、適切な運動で『機能』を改善すれば痛みはなくなります","手術以外に治る方法はありません","痛みがゼロになるまで安静にしましょう"],c:1,r:"「変形＝痛み」という誤った認識（破局的思考）を修正し、「動いても大丈夫」「機能は良くなる」という自己効力感を高めることが重要です。",s:"86ページ"},
    {q:"運動連鎖の視点から、膝の過外旋（Knee-in & Toe-out）を修正するために評価すべき足部の状態は？",o:["回外（内反）足","過回内（外反）足・扁平足","ハイアーチ","内転足"],c:1,r:"足部の過回内（距骨下関節回内）は下腿の内旋を誘導すると言われますが、荷重位では相対的なアライメントとしてKnee-in・下腿外旋の運動連鎖に関連します（※マニュアルの文脈では足部外反→下腿外旋）。",s:"14ページ"},
    {q:"高齢者の膝痛患者に対し、セルフエクササイズを指導する際の最も重要なポイントは？",o:["できるだけ多くの種目を教える","解剖学的な名前を覚えさせる","生活スタイルに合わせて、継続可能で効果を実感しやすい1-2種目に絞る","痛みを伴うストレッチを強制する"],c:2,r:"アドヒアランス（治療への参加・継続）を高めるため、シンプルで負担が少なく、かつ効果的なものを選定する必要があります。",s:"一般知識"},
    {q:"膝蓋骨のトラッキング（動きの軌道）異常を評価する際、Q角（Quadriceps Angle）が増大しているとリスクが高まる障害は？",o:["膝蓋骨内方脱臼","膝蓋骨外方脱臼・亜脱臼","大腿四頭筋断裂","前十字靭帯断裂"],c:1,r:"Q角が大きい（X脚傾向）と、大腿四頭筋の収縮時に膝蓋骨を外側へ引っ張るベクトル（Bowstring force）が強くなり、外方脱臼のリスクとなります。",s:"一般知識"},
    {q:"深屈曲（正座など）で膝裏が痛む場合、インピンジメント（挟み込み）を起こしている可能性が高い組織は？",o:["前十字靭帯","後十字靭帯","半月板後節および後方関節包","膝蓋下脂肪体"],c:2,r:"深屈曲では半月板の後方移動が必要ですが、移動が不十分だと大腿骨と脛骨の間に後節部や関節包が挟まり、痛みを生じます。",s:"47ページ"}
];

// --- 2つのプールを結合して使用する ---
const questionPool = poolPart1.concat(poolPart2);

// --- システムロジック ---
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

let currentQuizSet = [];
let currentQuestionIndex = 0;
let score = 0;

const startScreen = document.getElementById('start-screen');
const quizScreen = document.getElementById('quiz-screen');
const resultScreen = document.getElementById('result-screen');
const questionBox = document.getElementById('question');
const optionsBox = document.getElementById('options');
const feedbackBox = document.getElementById('feedback');
const nextBtn = document.getElementById('next-btn');
const progress = document.getElementById('progress');
const scoreDisplay = document.getElementById('score');

function startQuiz() {
    currentQuizSet = shuffle([...questionPool]).slice(0, 30);
    currentQuestionIndex = 0;
    score = 0;
    startScreen.style.display = 'none';
    resultScreen.style.display = 'none';
    quizScreen.style.display = 'block';
    showQuestion();
}

function resetQuiz(restart = false) {
    if (restart || confirm("テストを中断して最初の画面に戻りますか？")) {
        startScreen.style.display = 'block';
        quizScreen.style.display = 'none';
        resultScreen.style.display = 'none';
        currentQuestionIndex = 0;
        score = 0;
    }
}

function showQuestion() {
    const q = currentQuizSet[currentQuestionIndex];
    questionBox.textContent = `Q${currentQuestionIndex + 1}. ${q.q}`;
    optionsBox.innerHTML = '';
    feedbackBox.style.display = 'none';
    feedbackBox.className = 'feedback';
    nextBtn.classList.remove('active');
    progress.textContent = `問 ${currentQuestionIndex + 1} / 30`;
    scoreDisplay.textContent = `正解数: ${score}`;

    q.o.forEach((option, index) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.textContent = option;
        btn.onclick = () => checkAnswer(index, btn, q);
        optionsBox.appendChild(btn);
    });
}

function checkAnswer(selectedIndex, selectedBtn, q) {
    if (nextBtn.classList.contains('active')) return;

    const isCorrect = (selectedIndex === q.c);
    const options = document.querySelectorAll('.option-btn');

    if (isCorrect) {
        selectedBtn.classList.add('correct');
        feedbackBox.innerHTML = `<strong>正解！</strong><br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback';
        score++;
        scoreDisplay.textContent = `正解数: ${score}`;
    } else {
        selectedBtn.classList.add('incorrect');
        options[q.c].classList.add('correct');
        feedbackBox.innerHTML = `<strong>不正解...</strong><br>正解は「${q.o[q.c]}」です。<br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback error';
    }
    feedbackBox.style.display = 'block';
    nextBtn.classList.add('active');
}

function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < 30) {
        showQuestion();
    } else {
        showResult();
    }
}

function showResult() {
    quizScreen.style.display = 'none';
    resultScreen.style.display = 'block';
    document.getElementById('final-score').textContent = score;
    
    const percentage = (score / 30) * 100;
    let comment = "";
    if (percentage === 100) comment = "完璧です！マニュアルを完全にマスターしています。";
    else if (percentage >= 80) comment = "素晴らしい成績です！臨床で十分通用する知識です。";
    else if (percentage >= 60) comment = "合格ラインです。間違えた箇所を復習しましょう。";
    else comment = "もう少し復習が必要です。マニュアルを読み返して再挑戦しましょう。";
    
    const commentEl = document.getElementById('result-comment');
    if(commentEl) {
        commentEl.textContent = comment;
        commentEl.style.color = percentage >= 80 ? "#27ae60" : "#e74c3c";
    }
}
</script>
</body>
</html>
