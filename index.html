<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>膝痛治療マニュアル 完全攻略マスター（上級編）</title>
<style>
    body { font-family: "Helvetica Neue", Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f4f7f6; margin: 0; padding: 20px; }
    .container { max-width: 800px; margin: 0 auto; background: #fff; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); position: relative; }
    h1 { text-align: center; color: #c0392b; margin-bottom: 25px; font-size: 1.8em; border-bottom: 2px solid #eee; padding-bottom: 15px; }
    .reset-btn { position: absolute; top: 20px; right: 20px; background: #95a5a6; color: #fff; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85em; transition: 0.3s; }
    .reset-btn:hover { background: #7f8c8d; }
    .status-bar { background: #fce4ec; padding: 12px 20px; border-radius: 8px; display: flex; justify-content: space-between; color: #c0392b; font-weight: bold; margin-bottom: 25px; }
    .question-box { background: #fff5f5; border-left: 6px solid #e74c3c; padding: 20px; margin-bottom: 25px; font-size: 1.15em; font-weight: bold; line-height: 1.5; }
    .option-btn { display: block; width: 100%; padding: 15px; margin-bottom: 12px; background: #fff; border: 2px solid #e0e0e0; border-radius: 8px; text-align: left; cursor: pointer; transition: all 0.2s; font-size: 1em; color: #444; }
    .option-btn:hover { background-color: #ffebee; border-color: #c0392b; }
    .option-btn.correct { background-color: #d4edda; border-color: #28a745; color: #155724; }
    .option-btn.incorrect { background-color: #f8d7da; border-color: #dc3545; color: #721c24; }
    .feedback { display: none; margin-top: 20px; padding: 20px; border-radius: 8px; background: #f1f8e9; border: 1px solid #c8e6c9; color: #2e7d32; animation: fadeIn 0.3s; }
    .feedback.error { background: #fdecea; border: 1px solid #fadbd8; color: #7b241c; }
    .source-ref { display: block; margin-top: 8px; font-size: 0.85em; color: #666; text-align: right; font-style: italic; }
    .next-btn { display: block; width: 100%; padding: 18px; background: #e74c3c; color: #fff; border: none; border-radius: 8px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 25px; opacity: 0.6; pointer-events: none; transition: 0.3s; }
    .next-btn.active { opacity: 1; pointer-events: auto; }
    .next-btn:hover { background-color: #a93226; }
    #result-screen { display: none; text-align: center; padding: 20px; }
    .score-circle { width: 150px; height: 150px; background: #e74c3c; color: #fff; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 30px auto; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    .score-num { font-size: 3.5em; font-weight: bold; line-height: 1; }
    .score-label { font-size: 0.9em; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>
<div class="container">
    <div id="start-screen" style="text-align: center; padding: 40px 0;">
        <h1 style="border: none;">膝痛治療マニュアル<br>完全攻略マスター（上級編）</h1>
        <p style="font-size: 1.1em; margin-bottom: 30px;">全250問のプールから<br>ランダムに30問出題されます。</p>
        <p style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 40px;">合格ライン: 80%以上</p>
        <button class="next-btn active" onclick="startQuiz()">試験を開始する</button>
    </div>

    <div id="quiz-screen" style="display: none;">
        <button class="reset-btn" onclick="resetQuiz()">最初に戻る</button>
        <h1>膝痛クイズ</h1>
        <div class="status-bar">
            <span id="progress">問 1 / 30</span>
            <span id="score">正解数: 0</span>
        </div>
        <div id="question" class="question-box"></div>
        <div id="options"></div>
        <div id="feedback" class="feedback"></div>
        <button id="next-btn" class="next-btn" onclick="nextQuestion()">次の問題へ</button>
    </div>

    <div id="result-screen">
        <h2>試験終了</h2>
        <div class="score-circle">
            <span class="score-num" id="final-score">0</span>
            <span class="score-label">点 / 30点</span>
        </div>
        <p id="result-comment" style="font-size: 1.2em; margin: 20px 0;"></p>
        <button class="next-btn active" onclick="resetQuiz(true)">もう一度挑戦する</button>
    </div>
</div>

<script>
// --- 問題プール Part 1 (膝痛マニュアル上級 1-125問) ---
const poolPart1 = [
    // 概論・疫学・基礎
    {q:"Martinの報告によるMRI研究で、無症状の50代男性において半月板損傷が見つかる割合として正しいものは？",o:["約19%","約32%","約50%","約60%"],c:1,r:"50代男性では32%、女性では19%に無症状でも半月板損傷が見つかるとされています。",s:"3ページ"},
    {q:"70歳以上の男女におけるMRI所見として、最も適切な記述は？",o:["約半数に無症状の靭帯断裂が見られる","過半数に無症状の半月板損傷があり、軟骨摩耗はほぼ全員に見られる","骨棘形成は稀である","半月板損傷があれば必ず痛みが生じている"],c:1,r:"70歳以上では過半数に半月板損傷、ほぼ全員に軟骨摩耗や骨棘が確認されますが、必ずしも痛みの原因とは限りません。",s:"3ページ"},
    {q:"膝痛治療の思考プロセスにおいて「組織学的推論」と「力学的推論」の関係として正しいのは？",o:["まず力学的負荷を特定し、次に痛んでいる組織を探す","まず痛んでいる組織（発痛源）を特定し、次にその組織に負荷をかけた原因（メカニズム）を推論する","画像診断で組織を特定すれば、力学的推論は不要である","どちらも同時に行うものであり、順序はない"],c:1,r:"「どこが痛いのか（組織）」を特定した上で、「なぜ痛くなったのか（力学）」を考えるのが基本手順です。",s:"3ページ"},
    {q:"関節鏡手術において、意図せず損傷されるリスクがあり、術後の残存痛の原因となりやすい組織は？",o:["前十字靭帯","内側側副靭帯","膝蓋下脂肪体","外側半月板"],c:2,r:"関節鏡のポート（穴）作成時に、膝蓋下脂肪体を傷つけてしまい、それが後の痛みの原因になることがあります。",s:"5ページ"},
    {q:"膝関節伸展可動域の制限が及ぼす影響として、マニュアルで強調されている「負のループ」に含まれない要素は？",o:["高齢者特有の円背姿勢への移行","股関節伸展機能の低下（屈曲位拘縮）","歩行時のエネルギー効率の向上","活動量の低下と痛みの悪化"],c:2,r:"膝が伸びないと姿勢が悪化し、歩行効率も下がり、活動量が減ってさらに悪化するという負の連鎖に陥ります。",s:"7ページ"},

    // 歩行・バイオメカニクス
    {q:"歩行周期において「対側下肢が離床」し、単脚支持が始まるフェーズは？",o:["Initial Contact (IC)","Loading Response (LR)","Mid Stance (MSt)","Terminal Stance (TSt)"],c:2,r:"MSt（立脚中期）の始まりは、対側下肢が地面から離れた瞬間と定義されます。",s:"6ページ"},
    {q:"歩行周期において「踵が離床（Heel Off）」し、下腿が前方に傾斜していくフェーズは？",o:["Mid Stance (MSt)","Terminal Stance (TSt)","Pre Swing (PSw)","Initial Swing (ISw)"],c:1,r:"TSt（立脚終期）は踵離床から対側接地までを指し、この時期にアキレス腱や足底筋膜の機能が重要になります。",s:"6ページ"},
    {q:"スクリューホームムーブメント（SHM）の記述として正しいのは？",o:["膝伸展最終域で脛骨が内旋し、関節がロックされる","膝伸展最終域で脛骨が外旋し、関節がロックされる","膝屈曲初期に脛骨が外旋する","膝伸展に伴い大腿骨が外旋する（OKCの場合）"],c:1,r:"SHMは、膝伸展の最終域（約30度〜0度）で脛骨が外旋（大腿骨が内旋）し、骨性の安定性を高める機構です。",s:"一般知識"},
    {q:"膝伸展制限の因子として、マニュアルで挙げられている「前方組織」の制限因子は？",o:["半膜様筋","膝蓋下脂肪体","後外側支持機構","腓腹筋"],c:1,r:"膝蓋下脂肪体は前方に位置し、硬化すると膝蓋骨の動きを制限して伸展制限を引き起こします。",s:"8ページ"},

    // アライメント・回旋評価
    {q:"「スクインティングパテラ（Squinting Patella）」の病態として最も正確な記述は？",o:["膝蓋骨が外側を向いており、脱臼しやすい状態","大腿骨の内旋により膝蓋骨が内側を向いており、相対的に下腿外旋が生じている状態","膝蓋骨が高位にあり、不安定な状態","脛骨が内旋し、膝蓋骨も内側を向いている状態"],c:1,r:"「斜視」のように内側を向いた膝蓋骨のこと。大腿骨の内旋が主因で、結果として膝の過外旋（相対的下腿外旋）を作ります。",s:"13ページ"},
    {q:"脛骨粗面の位置による回旋評価で、「重度過外旋」と判断される基準は？",o:["脛骨粗面が膝蓋骨の外側縁より内側にある","脛骨粗面が膝蓋骨外側の接線上にある","脛骨粗面が膝蓋骨外側の接線よりさらに外側に位置する","脛骨粗面が膝蓋骨の中央真下にある"],c:2,r:"膝蓋骨外側の接線（垂線）よりも外側に脛骨粗面がある場合、重度の過外旋と判断します。",s:"10ページ"},
    {q:"「壺状変形（O脚変形）」において、脛骨近位外側で突出して見える骨は？",o:["大腿骨外側上顆","脛骨外側顆","腓骨頭","ガーディー結節"],c:2,r:"脛骨の外側変位と過外旋に伴い、腓骨頭が外側に飛び出し、下腿近位が壺のような形状を呈します。",s:"11ページ"},
    {q:"足部の「外反（回内）」が運動連鎖によって膝関節に及ぼす影響は？",o:["下腿の内旋を誘導し、膝内反を強める","下腿の外旋を誘導し、膝の過外旋ストレスを強める","下腿を前方へ傾斜させる","膝の過伸展を誘導する"],c:1,r:"足部外反は距骨下関節を介して下腿の外旋を誘導し、これが膝の過外旋（スクリューホームの破綻）につながります。",s:"14ページ"},
    {q:"膝OA患者の歩行（立脚終期：TSt）において、特徴的に見られる足部のアライメント異常は？",o:["過度な内反・底屈位での蹴り出し","過度な外反・背屈位での蹴り出し","中間位での蹴り出し","足指の屈曲を伴う蹴り出し"],c:1,r:"下腿の外方傾斜に伴い、足部は相対的に外反・背屈位となり、アブダクトリーツイストなどの異常運動を生じます。",s:"91ページ"},
    {q:"膝関節の「過外旋」を構成する要素として、最も適切な組み合わせは？",o:["大腿骨の外旋 ＋ 下腿の内旋","大腿骨の内旋 ＋ 下腿の外旋","大腿骨の屈曲 ＋ 下腿の伸展","大腿骨の内転 ＋ 下腿の外転"],c:1,r:"大腿骨が内旋し、下腿が外旋することで、膝関節に強い捻じれ（過外旋）が生じます。",s:"12ページ"},

    // 問診・鑑別
    {q:"問診で「動き始めが痛い」「朝起きた時が痛い」と訴える場合、最も疑われる病態は？",o:["急性炎症（組織損傷直後）","神経の圧迫","組織の癒着や滑走障害","骨折"],c:2,r:"「錆びついたドア」のように、動かしていない間に組織が固まり（癒着）、動き始めに引き剥がされる痛みが特徴です。",s:"25ページ"},
    {q:"「ズキンズキン」「何もしなくても痛い（自発痛）」という訴えから示唆される病態は？",o:["組織の癒着","活動性の高い炎症","筋肉の疲労","関節軟骨の摩耗"],c:1,r:"脈打つような痛みや安静時痛は、現在進行系の炎症（または腫瘍・感染などのRed flag）を示唆します。",s:"26ページ"},
    {q:"「階段を降りる時に痛い」場合に、バイオメカニクス的に最も負荷がかかっていると考えられる関節は？",o:["脛骨大腿関節（FT関節）","膝蓋大腿関節（PF関節）","近位橈尺関節","仙腸関節"],c:1,r:"降段動作では膝屈曲位で大腿四頭筋の遠心性収縮が必要となり、PF関節への圧縮力が最大化します。",s:"23ページ"},
    {q:"痛みの範囲が「指一本で示せる（ピンポイント）」場合に疑うべき組織として適切でないものは？",o:["膝蓋腱付着部","膝蓋下脂肪体（局所）","半月板の関節裂隙部","伏在神経の広範な支配領域"],c:3,r:"神経痛や筋膜性疼痛は広範囲に広がることが多く、ピンポイントで指せないことが多いです。",s:"25ページ"},
    {q:"平地歩行で「着地の瞬間に痛い」場合に疑うべき関節障害は？",o:["膝蓋大腿関節障害","脛骨大腿関節（FT関節）の荷重時痛","靭帯損傷","脂肪体の挟み込み"],c:1,r:"荷重応答期（LR）の衝撃吸収時の痛みは、FT関節（軟骨・骨・半月板）の荷重伝達障害をまず疑います。",s:"23ページ"},

    // 膝蓋下脂肪体
    {q:"膝蓋下脂肪体の評価法「屈曲伸展圧痛テスト」で陽性（脂肪体由来の痛み）とされる反応は？",o:["屈曲位で圧痛が増強する","伸展位で圧痛があり、屈曲位にすると圧痛が消失・減弱する","どの角度でも圧痛が変わらない","伸展位では圧痛がなく、屈曲位でのみ痛む"],c:1,r:"伸展位では脂肪体が押し出されて触れやすく、屈曲すると関節奥へ滑り込むため、屈曲で痛みが消えれば脂肪体由来と判断します。",s:"30ページ"},
    {q:"膝蓋下脂肪体の機能障害（硬化・線維化）を引き起こす「膝蓋骨の位置異常」は？",o:["膝蓋骨高位","膝蓋骨低位","膝蓋骨の外方傾斜のみ","膝蓋骨の回旋のみ"],c:1,r:"膝蓋骨低位（Patella Baja）は、脂肪体の可動域を狭め、内圧を高めて線維化を助長します。",s:"31ページ"},
    {q:"「リバーススクリューエクササイズ」において、徒手的に誘導する下腿の回旋方向は？",o:["外旋方向","内旋方向","回旋させない","屈伸のみ行う"],c:1,r:"過外旋（スクリューホームの過剰）を修正するため、下腿を「内旋」方向に誘導しながら膝を伸展させます。",s:"33ページ"},
    {q:"膝蓋下脂肪体の圧痛が最も生じやすい部位（好発部位）は？",o:["膝蓋靭帯の真上","膝蓋骨の上縁","膝蓋靭帯の内外側（特に外側）","脛骨粗面"],c:2,r:"膝蓋靭帯の両脇、特に出口となる外側部で肥厚・圧痛が生じやすいです。",s:"30ページ"},
    {q:"膝OAにおいて、膝蓋下脂肪体が内側に移動・肥厚する主なメカニズムは？",o:["内側裂隙が狭くなるから","内反変形により外側の組織（外側支帯・関節包）が緊張し、圧迫されて内側へ押し出されるから","重力の影響","膝蓋骨が内側へズレるから"],c:1,r:"内反変形で外側構成体の張力が高まり、外側のスペースが狭くなることで、脂肪体が内側へ「絞り出される」ように移動します。",s:"93ページ"},

    // 膝蓋腱・膝蓋支帯
    {q:"膝蓋腱炎（ジャンパー膝）における「屈曲伸展圧痛テスト」の反応として正しいのは？",o:["屈曲すると痛みが消える","屈曲すると腱が伸張され、圧痛が変わらないか増強する","伸展すると痛みが増強する","角度による変化はない"],c:1,r:"膝蓋腱は屈曲で伸張されるため、脂肪体とは逆に、屈曲位でも圧痛が残るか強くなります。",s:"34ページ"},
    {q:"大腿直筋の短縮評価（Elyテスト変法）を行う際、代償動作として注意すべき動きは？",o:["骨盤の後傾","骨盤の前傾（腰椎前弯の増強）","股関節の外転","膝の屈曲"],c:1,r:"大腿直筋が硬いと、膝屈曲時に骨盤を前傾させて（腰を反って）逃げようとします。",s:"34ページ"},
    {q:"膝蓋腱炎の治療において、大腿直筋の柔軟性改善とともに重要視されるバイオメカニクス的要素は？",o:["膝屈曲モーメントの増大","膝伸展モーメントの軽減（着地動作の改善など）","足関節背屈可動域の制限","股関節内転筋の強化"],c:1,r:"着地時などに膝が前に出すぎたり、重心が後方に残ると伸展モーメント（大腿四頭筋の張力）が増大し、腱に負担をかけます。",s:"37ページ"},
    {q:"膝蓋骨外側支持帯（Lateral Retinaculum）と連結し、膝蓋骨の動きに影響を与える組織は？",o:["内側広筋","腸脛靭帯（ITB-P）","半膜様筋","前十字靭帯"],c:1,r:"腸脛靭帯から分枝する線維束（ITB-P）が外側支持帯と連結し、膝蓋骨を外方・下方へ牽引します。",s:"113ページ"},
    {q:"外側広筋の滑走不全を改善するために、指を侵入させるべき筋間は？",o:["大腿直筋と中間広筋の間","外側広筋と大腿二頭筋の間（外側筋間中隔）","内側広筋と縫工筋の間","長内転筋と大内転筋の間"],c:1,r:"大腿二頭筋の前面から外側広筋の裏側へ指を入れ、大腿骨への付着部付近をリリースします。",s:"115ページ"},

    // 内側側副靭帯(MCL)
    {q:"MCL損傷の重症度分類において、「伸展位でも外反動揺性（緩み）がある」場合は何度に該当するか？",o:["I度（軽度）","II度（中等度）","III度（重度）","正常範囲内"],c:2,r:"伸展位での動揺性は、MCLだけでなく後方関節包や十字靭帯も損傷している可能性が高い重症（III度）を示唆します。",s:"41ページ"},
    {q:"MCLの触診において、圧痛が最も生じやすい部位（好発部位）は？",o:["関節裂隙レベル","脛骨付着部（鵞足の深層）","大腿骨内側上顆周辺（起始部）","MCLの中央部"],c:2,r:"大腿骨付着部（内側上顆）での損傷や炎症が最も頻度が高いです。",s:"41ページ"},
    {q:"MCL損傷後に膝の「屈曲制限」が生じるメカニズムとして正しいのは？",o:["MCLが短縮して伸びないから","屈曲に伴うMCLの「後方移動」が癒着により阻害されるから","半月板が挟まるから","関節液が溜まっているから"],c:1,r:"正常な屈曲時にはMCLは後方へスライドしますが、癒着するとこれが妨げられ、屈曲制限となります。",s:"42ページ"},
    {q:"MCLの滑走性を改善するための徒手操作として適切なのは？",o:["膝を外反させながら伸展する","下腿を「内旋」させながら屈伸し、MCL前方部を後方へ誘導する","下腿を外旋させて固定する","MCLを上から強く圧迫する"],c:1,r:"下腿内旋位での屈伸により、MCLと周辺組織（内側広筋や関節包）との滑走を促します。",s:"45ページ"},
    {q:"MCLの深層（深部内側側副靭帯）が直接結合している組織は？",o:["外側半月板","内側半月板","前十字靭帯","膝蓋腱"],c:1,r:"MCL深層は内側半月板と強固に結合しており、MCL損傷時に半月板損傷を合併しやすい理由となります。",s:"42ページ"},

    // 半月板
    {q:"半月板損傷のMRI所見「ダブルPCLサイン」が示唆する病態は？",o:["後十字靭帯の断裂","バケツ柄断裂により半月板が顆間窩へ変位している","円板状半月の存在","半月板の変性"],c:1,r:"断裂して反転した半月板がPCL（後十字靭帯）と並んで映り、PCLが2本あるように見えるサインです。",s:"48ページ"},
    {q:"外側半月板損傷を疑う「マクマレーテスト」の操作方法は？",o:["膝を屈曲し、下腿を「外旋・内反」させる","膝を屈曲し、下腿を「内旋・外反」させる","膝を伸展位で固定する","下腿を牽引する"],c:1,r:"外側半月板にストレスをかけるには、下腿を内旋させながら外反（Valgus）ストレスを加えます。",s:"48ページ"},
    {q:"膝伸展動作において、半月板は解剖学的にどちらへ移動するか？",o:["後方へ移動する","前方へ移動する","内側へ移動する","移動しない"],c:1,r:"大腿骨顆部の形状（ロールフォワード）に伴い、半月板は前方に押し出されるように移動します。",s:"47ページ"},
    {q:"半月板前方部の障害（痛み）に対し、膝蓋下脂肪体へのアプローチが有効な理由は？",o:["脂肪体が半月板を栄養しているから","脂肪体と半月板前方部は結合しており、脂肪体の柔軟性が半月板の移動（前方移動）を助けるから","脂肪体がクッションになるから","関係はない"],c:1,r:"脂肪体が硬いと半月板の前方移動が阻害され、挟み込みや牽引痛の原因となるためです。",s:"45ページ"},
    {q:"内側半月板損傷が疑われる患者の歩行分析（立脚終期：TSt）での着眼点は？",o:["膝の過伸展","距骨の過外旋（アブダクトリーツイスト）の有無","骨盤の後傾","足指の屈曲"],c:1,r:"TStでの過度な下腿外旋（距骨外旋）は、内側半月板に強い回旋・剪断ストレスを与え、損傷のリスクとなります。",s:"50ページ"},

    // 鵞足・半膜様筋
    {q:"鵞足炎と鑑別すべき、鵞足構成筋以外の疼痛要因は？",o:["伏在神経の絞扼","外側大腿皮神経痛","総腓骨神経麻痺","坐骨神経痛"],c:0,r:"伏在神経は鵞足部（縫工筋下）を通過するため、神経性の痛みを鵞足炎と誤診しやすいです。",s:"53ページ"},
    {q:"半腱様筋の伸張テストの正しい肢位は？",o:["股関節伸展・膝伸展","股関節を制限手前まで屈曲し、そこから膝を伸展させる","股関節外転・膝屈曲","股関節内旋・膝屈曲"],c:1,r:"SLRテストに近い肢位ですが、股関節屈曲位から膝を伸展させることでハムストリングスを選択的に伸張します。",s:"54ページ"},
    {q:"鵞足炎に対して「薄筋」をターゲットにしたリリースの際、筋を緩める（短縮させる）肢位は？",o:["股関節伸展・内転","股関節屈曲・外転・外旋","股関節屈曲・内転・内旋","膝伸展"],c:2,r:"薄筋の作用（股関節内転・屈曲・膝屈曲・内旋）に合わせて短縮位をとり、リリースを行います。",s:"58ページ"},
    {q:"半膜様筋の停止部（付着部）の特徴として正しいのは？",o:["脛骨内側顆の1箇所のみに付着する","腓骨頭に付着する","脛骨内側顆、斜膝窩靭帯、半月板など5つのアームに分かれて多方向に付着する","大腿骨に付着する"],c:2,r:"Direct arm, Anterior armなど複雑に分岐し、内側半月板の後角や後方関節包をも制御しています。",s:"59ページ"},
    {q:"半膜様筋痛の発生に関与する「アブダクトリーツイスト」の原因となる足部の状態は？",o:["過度な回外（内反）","過度な回内（外反）および背屈","底屈拘縮","内側縦アーチの挙上"],c:1,r:"立脚終期に足部が過回内（外反）しロックされると、踵が内側に振れる（下腿が急激に外旋する）動きが生じ、半膜様筋を伸張します。",s:"91ページ"},
    {q:"半膜様筋と腓腹筋内側頭の滑走不全（摩擦）が最も生じやすい動作フェーズは？",o:["遊脚期","立脚初期（IC）","立脚終期（TSt）での膝伸展・足背屈時","立位保持中"],c:2,r:"膝が伸展し、かつ足首が背屈（腓腹筋伸張）するTStで、両筋が互いに圧迫されながら滑走するため、摩擦が生じやすくなります。",s:"97ページ"},
];
    // --- 問題プール Part 2 (上級問題 後半 126-250) ---
const poolPart2 = [
    // 膝蓋下脂肪体（治療・応用）
    {q:"膝蓋下脂肪体の柔軟性を改善する際、徒手操作の方向として最も効果的なのは？",o:["上下方向への摩擦","内側～外側～内側へと移動させる","奥へ押し込む","回旋させる"],c:1,r:"脂肪体の硬い部分を見つけ、内側から外側、外側から内側へと移動させることで柔軟性を出します。",s:"110ページ"},
    {q:"膝蓋下脂肪体の上下運動を促すために利用する筋収縮は？",o:["ハムストリングス","前脛骨筋","大腿四頭筋（セッティング）","下腿三頭筋"],c:2,r:"大腿四頭筋の収縮（パテラセッティング）に伴う膝蓋骨の挙上を利用して、脂肪体を引き上げます。",s:"110ページ"},
    {q:"膝蓋骨低位（Patella Baja）の症例に対して、特に有効な徒手操作は？",o:["膝蓋骨の下方押し込み","膝蓋骨の引き上げ（上方誘導）","膝蓋骨の圧迫","膝蓋骨の回旋"],c:1,r:"膝蓋骨が下がって脂肪体の動きを阻害しているため、徒手的に引き上げた状態でセッティングを行います。",s:"111ページ"},

    // 膝蓋腱・膝蓋支帯（治療・応用）
    {q:"膝蓋支帯の滑走性が低下すると、膝蓋骨のどのような動きが制限されるか？",o:["屈曲・伸展","回旋のみ","上下左右の可動性","前後"],c:2,r:"支帯が硬くなると膝蓋骨の全方向（特に傾きや回旋を含む）の遊びが失われます。",s:"112ページ"},
    {q:"膝蓋支帯の柔軟性を改善する「ティルティング」操作とは？",o:["膝蓋骨を強く圧迫する","膝蓋骨を傾けて（Tilt）、支帯を伸張させる","膝蓋骨を回す","膝蓋骨を叩く"],c:1,r:"膝蓋骨の縁を持ち上げて傾けることで、深層の支帯や関節包をストレッチします。",s:"112ページ"},
    {q:"大腿直筋のストレッチにおいて、膝蓋腱への負担を減らすための工夫は？",o:["膝を最大屈曲する","股関節を伸展させつつ、膝屈曲は痛みが出ない角度（不完全屈曲）に留める","反動をつける","膝を伸ばす"],c:1,r:"完全屈曲すると膝蓋腱付着部に強い伸張ストレスがかかるため、筋腹を伸ばすことを意識します。",s:"39ページ"},

    // 内側側副靭帯（MCL）（治療・応用）
    {q:"MCL損傷後の癒着により「屈曲制限」がある場合、有効な徒手操作は？",o:["膝を外反させる","下腿を「内旋」させながら、MCL前方部を後方へ滑走させる","下腿を外旋させる","MCLを強く揉む"],c:1,r:"屈曲時にはMCLは後方へ移動する必要があります。下腿内旋はMCLを弛緩させ、後方移動を助けます。",s:"45ページ"},
    {q:"MCLの滑走性を改善する際、膝関節の動きはどうするか？",o:["伸展位で固定","屈曲位で固定","最終域手前での屈伸運動を繰り返す","回旋のみ"],c:2,r:"徒手的に組織を把持・誘導した状態で、屈伸運動を繰り返して滑走を促します。",s:"45ページ"},
    {q:"MCLへのストレスを減らすために、立脚期に制御すべき膝の動きは？",o:["内反・内旋","外反・外旋","屈曲・伸展","過伸展"],c:1,r:"Knee-in（外反）・Toe-out（外旋）はMCLを伸張させるため、この動作を修正します。",s:"41ページ"},

    // 半月板（治療・応用）
    {q:"内側半月板の後方移動を促し、屈曲時の挟み込みを防ぐために収縮させる筋は？",o:["大腿四頭筋","半膜様筋","膝窩筋","大腿二頭筋"],c:1,r:"半膜様筋は内側半月板後角に付着しており、収縮することで半月板を後方へ引き込みます。",s:"59ページ"},
    {q:"外側半月板の後方移動に関与し、屈曲時のインピンジメントを防ぐ筋は？",o:["半膜様筋","膝窩筋","大腿二頭筋","腓腹筋"],c:1,r:"膝窩筋は外側半月板後角に付着し、屈曲時にこれを後方へ引く作用があります。",s:"81ページ"},
    {q:"半月板損傷後のリハビリで「スクワット」を行う際、重要視されるアライメントは？",o:["Knee-inして四頭筋を効かせる","Knee-outして殿筋を効かせる","Knee-in/outのない、つま先と膝が同じ向き（ニュートラル）","骨盤後傾"],c:2,r:"回旋ストレスを排除するため、下肢アライメントを一直線に保つモーターコントロールが最重要です。",s:"50ページ"},

    // 鵞足・半膜様筋（治療・応用）
    {q:"鵞足炎に対する「組織間リリース」で、滑走させるべき組織の境界は？",o:["皮膚と脂肪","縫工筋・薄筋・半腱様筋の各筋間およびMCLとの間","骨と骨","神経と血管"],c:1,r:"鵞足構成筋同士や、その深層にあるMCLとの癒着を剥がすように滑走させます。",s:"58ページ"},
    {q:"半膜様筋と腓腹筋内側頭の滑走不全を改善するセルフエクササイズの肢位は？",o:["つま先を外に向け、膝を伸ばす","つま先を内に向け（下腿内旋）、足首を背屈して膝を屈伸する","つま先立ち","正座"],c:1,r:"下腿内旋・足関節背屈位にすることで、半膜様筋と腓腹筋に適度な張力を与えながら滑走を促せます。",s:"64ページ"},
    {q:"半膜様筋痛の原因となる「距骨外旋」を抑制するためにストレッチすべき筋は？",o:["前脛骨筋","長母趾屈筋","腓骨筋","第三腓骨筋"],c:1,r:"長母趾屈筋は距骨の後方を走行するため、硬くなると距骨を外旋位に固定してしまいます。",s:"65ページ"},

    // 伏在神経（治療・応用）
    {q:"伏在神経の「皮膚リリース」を行う際のタッチのコツは？",o:["指を深く沈める","爪を立てる","皮膚をつまみ上げ、紙を浮かせるようなイメージで滑らせる","強く擦る"],c:2,r:"伏在神経は皮神経であり表層を通るため、皮膚と皮下組織の間を広げるような繊細な操作が必要です。",s:"66ページ"},
    {q:"伏在神経リリースにおいて、股関節伸展可動域を改善する意義は？",o:["大殿筋を鍛えるため","歩行時の縫工筋（股関節屈曲筋）の遠心性収縮負担を減らすため","膝が伸びるから","足が速くなるから"],c:1,r:"股関節が伸展しないと、歩行の蹴り出し時に縫工筋が過剰に緊張し、下を通る伏在神経を圧迫します。",s:"71ページ"},
    {q:"伏在神経症状を誘発する「ハンター管（内転筋管）」の構成要素は？",o:["内側広筋、長内転筋、大内転筋","外側広筋、大腿二頭筋","縫工筋、薄筋","大腿直筋、中間広筋"],c:0,r:"内側広筋、長内転筋、大内転筋（および縫工筋の深層）で構成されるトンネルです。",s:"66ページ"},

    // 腸脛靭帯（治療・応用）
    {q:"腸脛靭帯炎に対する「収縮と短縮の繰り返し法」の目的は？",o:["筋力増強","筋緊張の緩和（リラクセーション）","筋肥大","持久力向上"],c:1,r:"痛みのある筋（大腿筋膜張筋など）を伸張位から短縮位へ動かし、ポンプ作用で血流を改善し緊張を落とします。",s:"77ページ"},
    {q:"腸脛靭帯の滑走性を改善するために、徒手的に引き離すべき筋間は？",o:["大腿直筋と内側広筋","腸脛靭帯と外側広筋","大腿二頭筋と半腱様筋","内側広筋と縫工筋"],c:1,r:"腸脛靭帯は外側広筋の表層を走行しており、この間の癒着が滑走障害の主因となります。",s:"77ページ"},
    {q:"腸脛靭帯炎のリハビリで、骨盤の側方動揺（トレンデレンブルグ）を抑えるために強化すべき筋は？",o:["大腿筋膜張筋","中殿筋","内転筋","腸腰筋"],c:1,r:"中殿筋の機能不全は骨盤の不安定性を招き、代償として腸脛靭帯（大腿筋膜張筋）への負担を増やします。",s:"75ページ"},

    // 膝窩筋（治療・応用）
    {q:"膝窩筋の機能を改善する「荷重位足部内転エクササイズ」で、固定すべき部位は？",o:["踵","母趾球","小趾球","膝"],c:1,r:"母趾球を床につけたまま、踵を外側に動かす（下腿を相対的に内旋させる）ことで膝窩筋を収縮させます。",s:"82ページ"},
    {q:"膝窩筋に対する「リバーススクリュー」の徒手操作の方向は？",o:["大腿を内旋、下腿を外旋","大腿を外旋、下腿を内旋","大腿を屈曲、下腿を伸展","圧迫のみ"],c:1,r:"過外旋（スクリューホームの過剰）を解くため、大腿骨を外旋、脛骨を内旋方向へ誘導します。",s:"82ページ"},
    {q:"膝窩筋腱溝（Popliteal hiatus）の圧痛を確認する際、触診すべき位置は？",o:["大腿骨内側上顆","大腿骨外側上顆の前方","腓骨頭の直上","脛骨粗面"],c:1,r:"外側側副靭帯（LCL）の前方、大腿骨外側上顆にある溝の部分です。",s:"81ページ"},

    // 変形性膝関節症（OA）（治療・応用）
    {q:"膝OAの進行抑制（軟骨保護）のために、歩行指導で最も重要なのは？",o:["大股で歩く","ラテラルスラスト（外側動揺）を抑制する","つま先立ちで歩く","膝を高く上げる"],c:1,r:"接地時の外側への横揺れ（スラスト）は、内側関節面への圧縮ストレスを劇的に高めるため、これを制御します。",s:"88ページ"},
    {q:"膝OAの痛み（組織へのメカニカルストレス）を減らすために、アプローチすべき「動きの要素」は？",o:["屈曲可動域","伸展可動域","回旋（特に過外旋）の修正","内転可動域"],c:2,r:"OA特有の痛みは、変形に伴う「過外旋」による組織のねじれや摩擦が主因であるため、回旋の修正が鍵となります。",s:"89ページ"},
    {q:"膝OA患者の「TSt（蹴り出し）」で見られる代償動作を修正するためのポイントは？",o:["足指を握らせる","距骨の過外旋（アブダクトリーツイスト）を防ぎ、まっすぐ蹴り出させる","膝を曲げさせる","腰を反らせる"],c:1,r:"つま先が外を向いて踵が内側に回る（ツイストする）動きを修正し、正しく後方へ蹴り出すように指導します。",s:"91ページ"},
    {q:"膝OAに対して「ヒールレイズ」を行う際、腓腹筋内側頭と半膜様筋の摩擦を防ぐための肢位は？",o:["つま先を外に向ける","つま先を内に向ける（下腿内旋位）","膝を完全に伸ばしきる","膝を深く曲げる"],c:1,r:"下腿内旋位で行うことで、過外旋による組織間の圧迫・摩擦を軽減しながら筋力を強化できます。",s:"64ページ"},
    {q:"膝OAの保存療法において、手術（TKA等）を回避するために最も重要な考え方は？",o:["変形は治らないので諦める","変形があっても「機能（動き）」を改善すれば痛みはコントロールできる","軟骨を再生させる","骨を削る"],c:1,r:"画像上の変形自体を治すことはできませんが、痛みの原因となっている「機能不全（動きの悪さ）」は徒手療法と運動で改善可能です。",s:"86ページ"},

    // その他・総合
    {q:"膝痛患者のセルフケア指導で、「テニスボール」を使用する際の注意点は？",o:["骨の上を強く押す","神経の上を転がす","筋肉の硬結（トリガーポイント）に対し、自重で持続圧迫（虚血性圧迫）を加える","痛くても我慢してグリグリする"],c:2,r:"強く擦ったり骨を圧迫したりせず、痛気持ちいいポイントを持続的に圧迫してリリースします。",s:"1339ページ"}, // ページ数は参考
    {q:"運動連鎖（Kinetic Chain）の観点から、膝痛治療において評価すべき隣接関節は？",o:["肘関節と手関節","股関節と足関節","頚椎と胸椎","顎関節"],c:1,r:"膝は股関節と足関節の中間に位置し、両者からの影響を直接受けるため、必ず評価が必要です。",s:"2ページ"},
    {q:"「痛みの認知行動療法」的アプローチとして、患者にかけるべき言葉は？",o:["痛いときは絶対に動かないでください","骨が変形しているので治りません","痛みの範囲内であれば、動かしても壊れないので大丈夫です","手術しかありません"],c:2,r:"痛みに対する過度な恐怖心（Fear-avoidance）を取り除き、活動性を維持させることが慢性痛改善の鍵です。",s:"263ページ"}
];

// --- 2つのプールを結合して使用する ---
const questionPool = poolPart1.concat(poolPart2);

// --- システムロジック ---
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

let currentQuizSet = [];
let currentQuestionIndex = 0;
let score = 0;

const startScreen = document.getElementById('start-screen');
const quizScreen = document.getElementById('quiz-screen');
const resultScreen = document.getElementById('result-screen');
const questionBox = document.getElementById('question');
const optionsBox = document.getElementById('options');
const feedbackBox = document.getElementById('feedback');
const nextBtn = document.getElementById('next-btn');
const progress = document.getElementById('progress');
const scoreDisplay = document.getElementById('score');

function startQuiz() {
    currentQuizSet = shuffle([...questionPool]).slice(0, 30);
    currentQuestionIndex = 0;
    score = 0;
    startScreen.style.display = 'none';
    resultScreen.style.display = 'none';
    quizScreen.style.display = 'block';
    showQuestion();
}

function resetQuiz(restart = false) {
    if (restart || confirm("テストを中断して最初の画面に戻りますか？")) {
        startScreen.style.display = 'block';
        quizScreen.style.display = 'none';
        resultScreen.style.display = 'none';
        currentQuestionIndex = 0;
        score = 0;
    }
}

function showQuestion() {
    const q = currentQuizSet[currentQuestionIndex];
    questionBox.textContent = `Q${currentQuestionIndex + 1}. ${q.q}`;
    optionsBox.innerHTML = '';
    feedbackBox.style.display = 'none';
    feedbackBox.className = 'feedback';
    nextBtn.classList.remove('active');
    progress.textContent = `問 ${currentQuestionIndex + 1} / 30`;
    scoreDisplay.textContent = `正解数: ${score}`;

    q.o.forEach((option, index) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.textContent = option;
        btn.onclick = () => checkAnswer(index, btn, q);
        optionsBox.appendChild(btn);
    });
}

function checkAnswer(selectedIndex, selectedBtn, q) {
    if (nextBtn.classList.contains('active')) return;

    const isCorrect = (selectedIndex === q.c);
    const options = document.querySelectorAll('.option-btn');

    if (isCorrect) {
        selectedBtn.classList.add('correct');
        feedbackBox.innerHTML = `<strong>正解！</strong><br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback';
        score++;
        scoreDisplay.textContent = `正解数: ${score}`;
    } else {
        selectedBtn.classList.add('incorrect');
        options[q.c].classList.add('correct');
        feedbackBox.innerHTML = `<strong>不正解...</strong><br>正解は「${q.o[q.c]}」です。<br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback error';
    }
    feedbackBox.style.display = 'block';
    nextBtn.classList.add('active');
}

function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < 30) {
        showQuestion();
    } else {
        showResult();
    }
}

function showResult() {
    quizScreen.style.display = 'none';
    resultScreen.style.display = 'block';
    document.getElementById('final-score').textContent = score;
    
    const percentage = (score / 30) * 100;
    let comment = "";
    if (percentage === 100) comment = "完璧です！マニュアルを完全にマスターしています。";
    else if (percentage >= 80) comment = "素晴らしい成績です！臨床で十分通用する知識です。";
    else if (percentage >= 60) comment = "合格ラインです。間違えた箇所を復習しましょう。";
    else comment = "もう少し復習が必要です。マニュアルを読み返して再挑戦しましょう。";
    
    const commentEl = document.getElementById('result-comment');
    if(commentEl) {
        commentEl.textContent = comment;
        commentEl.style.color = percentage >= 80 ? "#27ae60" : "#e74c3c";
    }
}
</script>
</body>
</html>
